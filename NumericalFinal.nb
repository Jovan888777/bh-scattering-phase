(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    108214,       2708]
NotebookOptionsPosition[    104927,       2650]
NotebookOutlinePosition[    105323,       2666]
CellTagsIndexPosition[    105280,       2663]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Numerical MST Scattering Phase Algorithm", "Title",
 CellChangeTimes->{{3.9587371904111004`*^9, 
  3.9587372059952745`*^9}},ExpressionUUID->"dcc1e1f8-3d52-4637-9663-\
3ad69970333c"],

Cell[CellGroupData[{

Cell["Setup", "Section",
 CellChangeTimes->{{3.9587374452733045`*^9, 
  3.958737446074485*^9}},ExpressionUUID->"c7bc48bd-b8ea-45e1-a5dc-\
0a37c5881b39"],

Cell["Loading relevant BHPT paclets.", "Text",
 CellChangeTimes->{{3.9587374993288994`*^9, 
  3.9587375177419767`*^9}},ExpressionUUID->"10f5a757-d742-4adb-9113-\
7b8b588262ce"],

Cell[BoxData[{
 RowBox[{"Needs", "[", "\"\<SpinWeightedSpheroidalHarmonics`\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Needs", "[", "\"\<KerrGeodesics`\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Needs", "[", "\"\<Teukolsky`\>\"", "]"}]}], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"aeb8ef5e-1618-4d69-b4c9-9cc8a8129c25"],

Cell[TextData[{
 "Generating a vector of values of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Epsilon]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\epsilon", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ee453d31-777f-4170-b06c-42f1be056d60"],
 " to run the algorithm on."
}], "Text",
 CellChangeTimes->{{3.958737551165986*^9, 
  3.9587375746830873`*^9}},ExpressionUUID->"02a874e2-8043-4f34-8cf3-\
748a1854f2dd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Epsilon]0Vals", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"x", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0.02`32", ",", "2`32", ",", "0.1`32"}], "}"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9587375491263123`*^9, 3.95873754947336*^9}, 
   3.9587394530021095`*^9, {3.959854480963682*^9, 3.9598544823099675`*^9}, {
   3.9598549093058577`*^9, 3.9598549107320576`*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"41b327a6-2b05-46da-ba9b-c4b090eb8eff"],

Cell["\<\
Defining precalculated expansions of relevant parameters to compare against \
the numerical result later.\
\>", "Text",
 CellChangeTimes->{{3.958737612953208*^9, 
  3.958737632371931*^9}},ExpressionUUID->"50d0239d-849b-4d42-80c9-\
013be3747125"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Nu]000Expansion", "[", 
   RowBox[{"q_", ",", "\[Epsilon]_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "7"}], "/", "6"}], "*", 
    RowBox[{"\[Epsilon]", "^", "2"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "9449"}], "/", "7560"}], "+", 
      RowBox[{"3", 
       RowBox[{
        RowBox[{"q", "^", "2"}], "/", "35"}]}]}], ")"}], 
    RowBox[{"\[Epsilon]", "^", "4", " ", 
     RowBox[{"(*", 
      RowBox[{"s", ",", " ", "l", ",", " ", 
       RowBox[{"m", " ", "=", " ", "0"}]}], "*)"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.958737652186485*^9, 3.958737666376253*^9}, {
  3.959854055388807*^9, 
  3.9598540558211994`*^9}},ExpressionUUID->"a5be18f4-c278-423e-82e6-\
5e780c5c73e1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Nu]220Expansion", "[", 
   RowBox[{"q_", ",", "\[Epsilon]_"}], "]"}], ":=", 
  RowBox[{"2", "-", 
   RowBox[{
    RowBox[{"107", "/", "210"}], "*", 
    RowBox[{"\[Epsilon]", "^", "2"}]}], "+", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"-", "1695233"}], "+", 
      RowBox[{"404250", " ", 
       SuperscriptBox["q", "2"]}]}], "9261000"], 
    RowBox[{"\[Epsilon]", "^", "4", " ", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"s", " ", "=", " ", "2"}], ",", " ", 
       RowBox[{"l", " ", "=", " ", "2"}], ",", " ", 
       RowBox[{"m", " ", "=", " ", "0"}]}], "*)"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.9598540811951704`*^9, 3.959854084400692*^9}, {
  3.959854310656731*^9, 3.9598543665912714`*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"2e1662c3-8f4a-4eef-903f-f3e0db789073"],

Cell[BoxData[
 RowBox[{
  RowBox[{"phase000Expansion", "[", 
   RowBox[{"q_", ",", "\[Epsilon]_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", "EulerGamma"}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"Log", "[", "2", "]"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"Log", "[", "\[Epsilon]", "]"}]}]}], ")"}], " ", 
    "\[Epsilon]"}], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"6", " ", "\[ImaginaryI]"}], "-", 
       RowBox[{"6", " ", "\[ImaginaryI]", " ", 
        SuperscriptBox["q", "2"]}], "+", 
       RowBox[{"6", " ", "\[ImaginaryI]", " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["q", "2"]}]]}], "+", 
       RowBox[{"11", " ", "\[Pi]", " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["q", "2"]}]]}]}], ")"}], " ", 
     SuperscriptBox["\[Epsilon]", "2"]}], 
    RowBox[{"12", " ", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["q", "2"]}]]}]], "+", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"36", " ", 
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox["q", "2"]}]]}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "33"}], "+", 
      RowBox[{"18", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "+", 
      RowBox[{"33", " ", 
       SuperscriptBox["q", "2"]}], "-", 
      RowBox[{"18", " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
       SuperscriptBox["q", "2"]}], "+", 
      RowBox[{"51", " ", 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["q", "2"]}]]}], "-", 
      RowBox[{"36", " ", "EulerGamma", " ", 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["q", "2"]}]]}], "+", 
      RowBox[{"18", " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["q", "2"]}]]}], "+", 
      RowBox[{"11", " ", 
       SuperscriptBox["\[Pi]", "2"], " ", 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["q", "2"]}]]}], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["q", "2"], " ", 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["q", "2"]}]]}], "-", 
      RowBox[{"36", " ", 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["q", "2"]}]], " ", 
       RowBox[{"Log", "[", "2", "]"}]}], "-", 
      RowBox[{"36", " ", 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["q", "2"]}]], " ", 
       RowBox[{"Log", "[", 
        RowBox[{
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["q", "2"]}]], " ", "\[Epsilon]"}], "]"}]}], "-", 
      RowBox[{"12", " ", 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["q", "2"]}]], " ", 
       RowBox[{"Zeta", "[", "3", "]"}]}]}], ")"}], " ", 
    SuperscriptBox["\[Epsilon]", "3"], " ", 
    RowBox[{"(*", 
     RowBox[{"s", ",", " ", "l", ",", " ", 
      RowBox[{"m", " ", "=", " ", "0"}]}], "*)"}]}]}]}]], "Input",
 CellChangeTimes->{{3.958737700095503*^9, 3.9587377236199026`*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"0d0b26c7-99c8-4e88-b75f-ed90bf2cf2e1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"phase010Expansion", "[", 
   RowBox[{"q_", ",", "\[Epsilon]_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "3"}], "+", 
      RowBox[{"2", " ", "EulerGamma"}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"Log", "[", "2", "]"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"Log", "[", "\[Epsilon]", "]"}]}]}], ")"}], " ", 
    "\[Epsilon]"}], "+", 
   FractionBox[
    RowBox[{"19", " ", "\[Pi]", " ", 
     SuperscriptBox["\[Epsilon]", "2"]}], "60"], "+", 
   RowBox[{
    FractionBox["1", "180"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"19", " ", 
       SuperscriptBox["\[Pi]", "2"]}], "-", 
      RowBox[{"9", " ", 
       SuperscriptBox["q", "2"]}], "-", 
      RowBox[{"60", " ", 
       RowBox[{"Zeta", "[", "3", "]"}]}]}], ")"}], " ", 
    SuperscriptBox["\[Epsilon]", "3"], " ", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"s", " ", "=", " ", "0"}], ",", " ", 
      RowBox[{"l", " ", "=", " ", "1"}], ",", " ", 
      RowBox[{"m", " ", "=", " ", "0"}]}], "*)"}]}]}]}]], "Input",
 CellChangeTimes->{{3.9587377261752267`*^9, 3.958737737408071*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"bc15df0d-3963-416c-8ac3-33968c68f71e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"phase110Expansion", "[", 
   RowBox[{"q_", ",", "\[Epsilon]_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    FractionBox["1", "4"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "5"}], "+", 
      RowBox[{"4", " ", "EulerGamma"}], "+", 
      RowBox[{"4", " ", 
       RowBox[{"Log", "[", "2", "]"}]}], "+", 
      RowBox[{"4", " ", 
       RowBox[{"Log", "[", "\[Epsilon]", "]"}]}]}], ")"}], " ", 
    "\[Epsilon]"}], "+", 
   RowBox[{
    FractionBox["1", "240"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"94", " ", "\[Pi]"}], "-", 
      RowBox[{"15", " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["q", "2"]}]}], ")"}], " ", 
    SuperscriptBox["\[Epsilon]", "2"]}], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"105", "+", 
       RowBox[{"188", " ", 
        SuperscriptBox["\[Pi]", "2"]}], "-", 
       RowBox[{"180", " ", 
        SuperscriptBox["q", "2"]}], "-", 
       RowBox[{"480", " ", 
        RowBox[{"Zeta", "[", "3", "]"}]}]}], ")"}], " ", 
     SuperscriptBox["\[Epsilon]", "3"]}], "1440"], " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"s", " ", "=", " ", "1"}], ",", " ", 
     RowBox[{"l", " ", "=", " ", "1"}], ",", " ", 
     RowBox[{"m", " ", "=", " ", "0"}]}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.958737849368309*^9, 3.958737864289324*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"d2d7177f-cb66-45c1-a0e0-517fd6891492"],

Cell[BoxData[
 RowBox[{
  RowBox[{"phase220Expansion", "[", 
   RowBox[{"q_", ",", "\[Epsilon]_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    FractionBox["1", "3"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "5"}], "+", 
      RowBox[{"3", " ", "EulerGamma"}], "+", 
      RowBox[{"3", " ", 
       RowBox[{"Log", "[", "2", "]"}]}], "+", 
      RowBox[{"3", " ", 
       RowBox[{"Log", "[", "\[Epsilon]", "]"}]}]}], ")"}], " ", 
    "\[Epsilon]"}], "+", 
   FractionBox[
    RowBox[{"107", " ", "\[Pi]", " ", 
     SuperscriptBox["\[Epsilon]", "2"]}], "420"], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1015"}], "+", 
       RowBox[{"1926", " ", 
        SuperscriptBox["\[Pi]", "2"]}], "-", 
       RowBox[{"945", " ", 
        SuperscriptBox["q", "2"]}], "-", 
       RowBox[{"7560", " ", 
        RowBox[{"Zeta", "[", "3", "]"}]}]}], ")"}], " ", 
     SuperscriptBox["\[Epsilon]", "3"]}], "22680"], " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"s", " ", "=", " ", "2"}], ",", " ", 
     RowBox[{"l", " ", "=", " ", "2"}], ",", " ", 
     RowBox[{"m", " ", "=", " ", "0"}]}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.958737878187581*^9, 3.9587378858604536`*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"30b66338-171e-4fae-b6aa-fac1b8cef2ad"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Numerical Phase Algorithm Module", "Section",
 CellChangeTimes->{{3.958737228039956*^9, 3.9587372500169888`*^9}, {
  3.95873745520936*^9, 3.9587374561272607`*^9}, {3.9588234141122165`*^9, 
  3.958823415334225*^9}},ExpressionUUID->"88c32fa4-0938-4d73-971f-\
41a0ab953349"],

Cell[TextData[{
 "The main numerical scattering phase module. The module takes as input:\n- \
n: To what order we want appropriate MST coefficients while calculating the \
phase. A recommended value is around 10.\n- nUp: How many higher raising \
ratios we want to determine the n-th MST coefficient. Helps with stability. \
Recommended value is around 5.\n- s: The spin of the perturbation. Note that \
if the final goal is calculate the phase for some positive ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["s", "TI"], TraditionalForm], "errors" -> {}, "input" -> "s", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e380f0d3-9a8d-4328-879e-fd4dd038de17"],
 ", say 2, you should input -2 here as the intermediate step in determining ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[Null]", 
          RowBox[{"-", 
            StyleBox["s", "TI"]}]], 
         SubsuperscriptBox[
          StyleBox["B", "TI"], 
          RowBox[{
            StyleBox["l", "TI"], 
            StyleBox["m", "TI"], "\[Omega]"}], 
          RowBox[{"(", 
            RowBox[{
              StyleBox["r", "TI"], 
              StyleBox["e", "TI"], 
              StyleBox["f", "TI"], 
              StyleBox["l", "TI"]}], ")"}]], 
         SubscriptBox["/", 
          RowBox[{"-", 
            StyleBox["s", "TI"]}]], 
         SubsuperscriptBox[
          StyleBox["B", "TI"], 
          RowBox[{
            StyleBox["l", "TI"], 
            StyleBox["m", "TI"], "\[Omega]"}], 
          RowBox[{"(", 
            RowBox[{
              StyleBox["i", "TI"], 
              StyleBox["n", "TI"], 
              StyleBox["c", "TI"]}], ")"}]]}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "_{-s}B^{(refl)}_{lm\\omega} / _{-s}B^{(inc)}_{lm\\omega}", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b317ed68-ae61-4d07-b096-59956629f4b8"],
 " requires the sign of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["s", "TI"], TraditionalForm], "errors" -> {}, "input" -> "s", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "94a2e13e-f3e4-4fd1-95f9-d04f95c88e96"],
 " to be flipped.\n- l, m: Integers enumerating the basis of solutions of the \
Teukolsky equation.\n- q: The black hole spin parameter.\n- ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Epsilon]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\epsilon", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "613e7e0a-ef99-495a-8e63-44abcd49bb9d"],
 ": the value of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"2", 
         StyleBox["M", "TI"], "\[Omega]"}], TraditionalForm], "errors" -> {}, 
     "input" -> "2M\\omega", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "12adf3dd-7d4e-4e7f-838a-a7593e209b10"],
 " we are evaluating the phase for.\nThe calculation is carried out by \
recovering the numerical value for ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Nu]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\nu", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "33939c12-c4e7-4b2f-b2c9-5d630e5c4d99"],
 " using BHPT\[CloseCurlyQuote]s Teukolsky paclet\[CloseCurlyQuote]s \
RenormalizedAngularMomentum function, determining the lowest n + nUp (not n \
for stability) indexed raising ratios with R[n + 6] set to zero, getting the \
MST coefficients from them, then finally inserting these into the appropriate \
formulas to get the scattering phase."
}], "Text",
 CellChangeTimes->{{3.9587382299725437`*^9, 3.958738237937641*^9}, {
  3.9587383395952616`*^9, 3.9587386478111115`*^9}, {3.9587386837009697`*^9, 
  3.9587388167754617`*^9}, {3.9587390383834076`*^9, 3.958739147837264*^9}, {
  3.958740109176935*^9, 
  3.9587401688004017`*^9}},ExpressionUUID->"6bcc4ed6-b175-443d-8da7-\
a06b554f55a9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"expPhase", "[", 
   RowBox[{
   "n_", ",", "nUp_", ",", "s_", ",", "l_", ",", "m_", ",", "q_", ",", 
    "\[Epsilon]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]", ",", "\[Kappa]", ",", 
      "\[Tau]", ",", "\[Lambda]", ",", "neg\[Lambda]", ",", "\[Nu]", ",", 
      "ii", ",", "Ri", ",", "R", ",", "an", ",", "Aplus", ",", "Aminus", ",", 
      "Knu", ",", "aNegNuNeg1", ",", "KNegNuNeg1", ",", "\[Omega]", ",", 
      "BreflOverBinc", ",", "Cstar", ",", "expPhaseVal"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Alpha]", "[", "i_", "]"}], ":=", 
      RowBox[{"I", "*", "\[Epsilon]", "*", "\[Kappa]", "*", 
       RowBox[{"(", 
        RowBox[{"i", "+", "\[Nu]", "+", "1", "+", "s", "+", 
         RowBox[{"I", "*", "\[Epsilon]"}]}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{"i", "+", "\[Nu]", "+", "1", "+", "s", "-", 
         RowBox[{"I", "*", "\[Epsilon]"}]}], ")"}], "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"i", "+", "\[Nu]", "+", "1", "+", 
          RowBox[{"I", "*", "\[Tau]"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"i", "+", "\[Nu]", "+", "1"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "*", "i"}], "+", 
            RowBox[{"2", "*", "\[Nu]"}], "+", "3"}], ")"}]}], ")"}]}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Beta]", "[", "i_", "]"}], ":=", 
      RowBox[{
       RowBox[{"-", "\[Lambda]"}], "-", 
       RowBox[{"s", "*", 
        RowBox[{"(", 
         RowBox[{"s", "+", "1"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"i", "+", "\[Nu]"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"i", "+", "\[Nu]", "+", "1"}], ")"}]}], "+", 
       RowBox[{"\[Epsilon]", "^", "2"}], "+", 
       RowBox[{"\[Epsilon]", "*", 
        RowBox[{"(", 
         RowBox[{"\[Epsilon]", "-", 
          RowBox[{"m", "*", "q"}]}], ")"}]}], "+", 
       RowBox[{"\[Epsilon]", "*", 
        RowBox[{"(", 
         RowBox[{"\[Epsilon]", "-", 
          RowBox[{"m", "*", "q"}]}], ")"}], "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"s", "^", "2"}], "+", 
           RowBox[{"\[Epsilon]", "^", "2"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "+", "\[Nu]"}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"i", "+", "\[Nu]", "+", "1"}], ")"}]}], ")"}]}]}]}]}], 
     " ", ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Gamma]", "[", "i_", "]"}], ":=", 
      RowBox[{
       RowBox[{"-", "I"}], "*", "\[Epsilon]", "*", "\[Kappa]", "*", 
       RowBox[{"(", 
        RowBox[{"i", "+", "\[Nu]", "-", "s", "+", 
         RowBox[{"I", "*", "\[Epsilon]"}]}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{"i", "+", "\[Nu]", "-", "s", "-", 
         RowBox[{"I", "*", "\[Epsilon]"}]}], ")"}], "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"i", "+", "\[Nu]", "-", 
          RowBox[{"I", "*", "\[Tau]"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"i", "+", "\[Nu]"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "i"}], "+", 
            RowBox[{"2", "\[Nu]"}], "-", "1"}], ")"}]}], ")"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]", "=", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"1", "-", 
        RowBox[{"q", "^", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Tau]", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Epsilon]", "-", 
         RowBox[{"m", "*", "q"}]}], ")"}], "/", "\[Kappa]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Lambda]", "=", 
      RowBox[{"SpinWeightedSpheroidalEigenvalue", "[", 
       RowBox[{"s", ",", "l", ",", "m", ",", 
        RowBox[{"q", "*", 
         RowBox[{"\[Epsilon]", "/", "2"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"neg\[Lambda]", "=", 
      RowBox[{"SpinWeightedSpheroidalEigenvalue", "[", 
       RowBox[{
        RowBox[{"-", "s"}], ",", "l", ",", "m", ",", 
        RowBox[{"q", "*", 
         RowBox[{"\[Epsilon]", "/", "2"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Nu]", "=", 
      RowBox[{"RenormalizedAngularMomentum", "[", 
       RowBox[{"s", ",", "l", ",", "m", ",", "q", ",", 
        RowBox[{"\[Epsilon]", "/", "2"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"ii", "=", 
        RowBox[{"n", "+", "nUp"}]}], ",", 
       RowBox[{"ii", ">=", "1"}], ",", 
       RowBox[{"ii", "--"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ii", "==", 
           RowBox[{"n", "+", "nUp"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Ri", "=", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"\[Gamma]", "[", "ii", "]"}]}], "/", 
            RowBox[{"\[Beta]", "[", "ii", "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Ri", "=", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"\[Gamma]", "[", "ii", "]"}]}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Beta]", "[", "ii", "]"}], "+", 
              RowBox[{
               RowBox[{"\[Alpha]", "[", "ii", "]"}], "*", 
               RowBox[{"R", "[", 
                RowBox[{"ii", "+", "1"}], "]"}]}]}], ")"}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"R", "[", "ii", "]"}], "=", "Ri"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"an", "[", "0", "]"}], "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"an", "[", "1", "]"}], "=", 
      RowBox[{"R", "[", "1", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"ii", "=", "2"}], ",", 
       RowBox[{"ii", "<=", "n"}], ",", 
       RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"an", "[", "ii", "]"}], "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"\[Beta]", "[", 
              RowBox[{"ii", "-", "1"}], "]"}]}], "*", 
            RowBox[{"an", "[", 
             RowBox[{"ii", "-", "1"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"\[Gamma]", "[", 
             RowBox[{"ii", "-", "1"}], "]"}], "*", 
            RowBox[{"an", "[", 
             RowBox[{"ii", "-", "2"}], "]"}]}]}], ")"}], "/", 
         RowBox[{"\[Alpha]", "[", 
          RowBox[{"ii", "-", "1"}], "]"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"ii", "=", 
        RowBox[{"-", "1"}]}], ",", 
       RowBox[{"ii", ">=", 
        RowBox[{"-", "n"}]}], ",", 
       RowBox[{"ii", "--"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"an", "[", "ii", "]"}], "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"\[Beta]", "[", 
              RowBox[{"ii", "+", "1"}], "]"}]}], "*", 
            RowBox[{"an", "[", 
             RowBox[{"ii", "+", "1"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"\[Alpha]", "[", 
             RowBox[{"ii", "+", "1"}], "]"}], "*", 
            RowBox[{"an", "[", 
             RowBox[{"ii", "+", "2"}], "]"}]}]}], ")"}], "/", 
         RowBox[{"\[Gamma]", "[", 
          RowBox[{"ii", "+", "1"}], "]"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Aplus", "=", 
      RowBox[{
       RowBox[{"E", "^", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "Pi"}], "/", "2"}], "*", "\[Epsilon]"}], ")"}]}], "*", 
       RowBox[{"E", "^", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Pi", "/", "2"}], "*", "I", "*", 
          RowBox[{"(", 
           RowBox[{"\[Nu]", "+", "1", "-", "s"}], ")"}]}], ")"}]}], "*", 
       RowBox[{"2", "^", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "s", "-", 
          RowBox[{"I", "*", "\[Epsilon]"}]}], ")"}]}], "*", 
       RowBox[{
        RowBox[{"Gamma", "[", 
         RowBox[{"\[Nu]", "+", "1", "-", "s", "+", 
          RowBox[{"I", "*", "\[Epsilon]"}]}], "]"}], "/", 
        RowBox[{"Gamma", "[", 
         RowBox[{"\[Nu]", "+", "1", "+", "s", "-", 
          RowBox[{"I", "*", "\[Epsilon]"}]}], "]"}]}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"an", "[", "ii", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", 
           RowBox[{"-", "n"}], ",", "n"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Aminus", "=", 
      RowBox[{
       RowBox[{"2", "^", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "-", "s", "+", 
          RowBox[{"I", "*", "\[Epsilon]"}]}], ")"}]}], "*", 
       RowBox[{"E", "^", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "I"}], "*", 
          RowBox[{"Pi", "/", "2"}], "*", 
          RowBox[{"(", 
           RowBox[{"\[Nu]", "+", "1", "+", "s"}], ")"}]}], ")"}]}], "*", 
       RowBox[{"E", "^", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "Pi"}], "*", 
          RowBox[{"\[Epsilon]", "/", "2"}]}], ")"}]}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "^", "ii"}], "*", 
          RowBox[{
           RowBox[{"Pochhammer", "[", 
            RowBox[{
             RowBox[{"\[Nu]", "+", "1", "+", "s", "-", 
              RowBox[{"I", "*", "\[Epsilon]"}]}], ",", "ii"}], "]"}], "/", 
           RowBox[{"Pochhammer", "[", 
            RowBox[{
             RowBox[{"\[Nu]", "+", "1", "-", "s", "+", 
              RowBox[{"I", "*", "\[Epsilon]"}]}], ",", "ii"}], "]"}]}], "*", 
          RowBox[{"an", "[", "ii", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", 
           RowBox[{"-", "n"}], ",", "n"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Knu", "=", 
      RowBox[{
       RowBox[{"E", "^", 
        RowBox[{"(", 
         RowBox[{"I", "*", "\[Epsilon]", "*", "\[Kappa]"}], ")"}]}], "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", "*", "\[Epsilon]", "*", "\[Kappa]"}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"s", "-", "\[Nu]"}], ")"}]}], "*", 
       RowBox[{"2", "^", 
        RowBox[{"(", 
         RowBox[{"-", "s"}], ")"}]}], "*", 
       RowBox[{"Gamma", "[", 
        RowBox[{"1", "-", "s", "-", 
         RowBox[{"2", "*", "I", "*", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Epsilon]", "+", "\[Tau]"}], ")"}], "/", "2"}]}]}], 
        "]"}], "*", 
       RowBox[{
        RowBox[{"Gamma", "[", 
         RowBox[{
          RowBox[{"2", "\[Nu]"}], "+", "2"}], "]"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Gamma", "[", 
           RowBox[{"\[Nu]", "+", "1", "-", "s", "+", 
            RowBox[{"I", "*", "\[Epsilon]"}]}], "]"}], "*", 
          RowBox[{"Gamma", "[", 
           RowBox[{"\[Nu]", "+", "1", "+", 
            RowBox[{"I", "*", "\[Tau]"}]}], "]"}], "*", 
          RowBox[{"Gamma", "[", 
           RowBox[{"\[Nu]", "+", "1", "+", "s", "+", 
            RowBox[{"I", "*", "\[Epsilon]"}]}], "]"}]}], ")"}]}], "*", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], "^", "ii"}], "*", 
           RowBox[{
            RowBox[{"Gamma", "[", 
             RowBox[{"ii", "+", 
              RowBox[{"2", "\[Nu]"}], "+", "1"}], "]"}], "/", 
            RowBox[{"ii", "!"}]}], "*", 
           RowBox[{
            RowBox[{"Gamma", "[", 
             RowBox[{"ii", "+", "\[Nu]", "+", "1", "+", "s", "+", 
              RowBox[{"I", "*", "\[Epsilon]"}]}], "]"}], "/", 
            RowBox[{"Gamma", "[", 
             RowBox[{"ii", "+", "\[Nu]", "+", "1", "-", "s", "-", 
              RowBox[{"I", "*", "\[Epsilon]"}]}], "]"}]}], "*", 
           RowBox[{
            RowBox[{"Gamma", "[", 
             RowBox[{"ii", "+", "\[Nu]", "+", "1", "+", 
              RowBox[{"I", "*", "\[Tau]"}]}], "]"}], "/", 
            RowBox[{"Gamma", "[", 
             RowBox[{"ii", "+", "\[Nu]", "+", "1", "-", 
              RowBox[{"I", "*", "\[Tau]"}]}], "]"}]}], "*", 
           RowBox[{"an", "[", "ii", "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "0", ",", "n"}], "}"}]}], "]"}], "/", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}], "^", "ii"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"-", "ii"}], ")"}], "!"}], "*", 
              RowBox[{"Pochhammer", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"2", "\[Nu]"}], "+", "2"}], ",", "ii"}], "]"}]}], 
             ")"}]}], "*", 
           RowBox[{
            RowBox[{"Pochhammer", "[", 
             RowBox[{
              RowBox[{"\[Nu]", "+", "1", "+", "s", "-", 
               RowBox[{"I", "*", "\[Epsilon]"}]}], ",", "ii"}], "]"}], "/", 
            RowBox[{"Pochhammer", "[", 
             RowBox[{
              RowBox[{"\[Nu]", "+", "1", "-", "s", "+", 
               RowBox[{"I", "*", "\[Epsilon]"}]}], ",", "ii"}], "]"}]}], "*", 
           RowBox[{"an", "[", "ii", "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", 
            RowBox[{"-", "n"}], ",", "0"}], "}"}]}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"ii", "=", 
        RowBox[{"-", "n"}]}], ",", 
       RowBox[{"ii", "<=", "n"}], ",", 
       RowBox[{"ii", "++"}], ",", 
       RowBox[{
        RowBox[{"aNegNuNeg1", "[", 
         RowBox[{"-", "ii"}], "]"}], "=", 
        RowBox[{"an", "[", "ii", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"KNegNuNeg1", "=", 
      RowBox[{
       RowBox[{"E", "^", 
        RowBox[{"(", 
         RowBox[{"I", "*", "\[Epsilon]", "*", "\[Kappa]"}], ")"}]}], "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", "*", "\[Epsilon]", "*", "\[Kappa]"}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"s", "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "\[Nu]"}], "-", "1"}], ")"}]}], ")"}]}], "*", 
       RowBox[{"2", "^", 
        RowBox[{"(", 
         RowBox[{"-", "s"}], ")"}]}], "*", 
       RowBox[{"Gamma", "[", 
        RowBox[{"1", "-", "s", "-", 
         RowBox[{"2", "*", "I", "*", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Epsilon]", "+", "\[Tau]"}], ")"}], "/", "2"}]}]}], 
        "]"}], "*", 
       RowBox[{
        RowBox[{"Gamma", "[", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "\[Nu]"}], "-", "1"}], ")"}]}], "+", "2"}], "]"}], 
        "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Gamma", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "\[Nu]"}], "-", "1"}], ")"}], "+", "1", "-", "s", 
            "+", 
            RowBox[{"I", "*", "\[Epsilon]"}]}], "]"}], "*", 
          RowBox[{"Gamma", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "\[Nu]"}], "-", "1"}], ")"}], "+", "1", "+", 
            RowBox[{"I", "*", "\[Tau]"}]}], "]"}], "*", 
          RowBox[{"Gamma", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "\[Nu]"}], "-", "1"}], ")"}], "+", "1", "+", "s", 
            "+", 
            RowBox[{"I", "*", "\[Epsilon]"}]}], "]"}]}], ")"}]}], "*", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], "^", "ii"}], "*", 
           RowBox[{
            RowBox[{"Gamma", "[", 
             RowBox[{"ii", "+", 
              RowBox[{"2", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "\[Nu]"}], "-", "1"}], ")"}]}], "+", "1"}], 
             "]"}], "/", 
            RowBox[{"ii", "!"}]}], "*", 
           RowBox[{
            RowBox[{"Gamma", "[", 
             RowBox[{"ii", "+", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "\[Nu]"}], "-", "1"}], ")"}], "+", "1", "+", "s",
               "+", 
              RowBox[{"I", "*", "\[Epsilon]"}]}], "]"}], "/", 
            RowBox[{"Gamma", "[", 
             RowBox[{"ii", "+", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "\[Nu]"}], "-", "1"}], ")"}], "+", "1", "-", "s",
               "-", 
              RowBox[{"I", "*", "\[Epsilon]"}]}], "]"}]}], "*", 
           RowBox[{
            RowBox[{"Gamma", "[", 
             RowBox[{"ii", "+", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "\[Nu]"}], "-", "1"}], ")"}], "+", "1", "+", 
              RowBox[{"I", "*", "\[Tau]"}]}], "]"}], "/", 
            RowBox[{"Gamma", "[", 
             RowBox[{"ii", "+", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "\[Nu]"}], "-", "1"}], ")"}], "+", "1", "-", 
              RowBox[{"I", "*", "\[Tau]"}]}], "]"}]}], "*", 
           RowBox[{"aNegNuNeg1", "[", "ii", "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "0", ",", "n"}], "}"}]}], "]"}], "/", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}], "^", "ii"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"-", "ii"}], ")"}], "!"}], "*", 
              RowBox[{"Pochhammer", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"2", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "\[Nu]"}], "-", "1"}], ")"}]}], "+", "2"}], 
                ",", "ii"}], "]"}]}], ")"}]}], "*", 
           RowBox[{
            RowBox[{"Pochhammer", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "\[Nu]"}], "-", "1"}], ")"}], "+", "1", "+", 
               "s", "-", 
               RowBox[{"I", "*", "\[Epsilon]"}]}], ",", "ii"}], "]"}], "/", 
            RowBox[{"Pochhammer", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "\[Nu]"}], "-", "1"}], ")"}], "+", "1", "-", 
               "s", "+", 
               RowBox[{"I", "*", "\[Epsilon]"}]}], ",", "ii"}], "]"}]}], "*", 
           RowBox[{"aNegNuNeg1", "[", "ii", "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", 
            RowBox[{"-", "n"}], ",", "0"}], "}"}]}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Omega]", "=", 
      RowBox[{"\[Epsilon]", "/", "2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"BreflOverBinc", "=", 
      RowBox[{
       RowBox[{"\[Omega]", "^", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "s"}], ")"}]}], "*", 
       RowBox[{"E", "^", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "I"}], "*", "\[Epsilon]", 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Kappa]"}], ")"}]}], ")"}]}], "*", 
       RowBox[{"E", "^", 
        RowBox[{"(", 
         RowBox[{"2", "*", "I", "*", "\[Epsilon]", "*", 
          RowBox[{"Log", "[", "\[Epsilon]", "]"}]}], ")"}]}], "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Knu", "+", 
          RowBox[{"I", "*", 
           RowBox[{"E", "^", 
            RowBox[{"(", 
             RowBox[{"I", "*", "Pi", "*", "\[Nu]"}], ")"}]}], "*", 
           "KNegNuNeg1"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"Knu", "-", 
          RowBox[{"I", "*", 
           RowBox[{"E", "^", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "I"}], "*", "Pi", "*", "\[Nu]"}], ")"}]}], "*", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"Pi", "*", 
              RowBox[{"(", 
               RowBox[{"\[Nu]", "-", "s", "+", 
                RowBox[{"I", "*", "\[Epsilon]"}]}], ")"}]}], "]"}], "/", 
            RowBox[{"Sin", "[", 
             RowBox[{"Pi", "*", 
              RowBox[{"(", 
               RowBox[{"\[Nu]", "+", "s", "-", 
                RowBox[{"I", "*", "\[Epsilon]"}]}], ")"}]}], "]"}]}], "*", 
           "KNegNuNeg1"}]}], ")"}]}], "*", 
       RowBox[{"Aminus", "/", "Aplus"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"s", "==", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Cstar", "=", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"s", "==", 
          RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Cstar", "=", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"neg\[Lambda]", "+", "2", "+", 
               RowBox[{
                RowBox[{"q", "^", "2"}], "*", 
                RowBox[{"\[Omega]", "^", "2"}]}], "-", 
               RowBox[{"2", "m", "*", "q", "*", "\[Omega]"}]}], ")"}], "^", 
             "2"}], "+", 
            RowBox[{"4", "*", "m", "*", "q", "*", "\[Omega]"}], "-", 
            RowBox[{"4", 
             RowBox[{"q", "^", "2"}], "*", 
             RowBox[{"\[Omega]", "^", "2"}]}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Cstar", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"\[Lambda]", "+", "2"}], ")"}], "^", "2"}], "+", 
                 RowBox[{"4", "q", "*", "m", "*", "\[Omega]"}], "-", 
                 RowBox[{"4", "*", 
                  RowBox[{"q", "^", "2"}], "*", 
                  RowBox[{"\[Omega]", "^", "2"}]}]}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Lambda]", "^", "2"}], "+", 
                 RowBox[{"36", "q", "*", "m", "*", "\[Omega]"}], "-", 
                 RowBox[{"36", 
                  RowBox[{"q", "^", "2"}], "*", 
                  RowBox[{"\[Omega]", "^", "2"}]}]}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", "\[Lambda]"}], "+", "3"}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"96", 
                  RowBox[{"q", "^", "2"}], "*", 
                  RowBox[{"\[Omega]", "^", "2"}]}], "-", 
                 RowBox[{"48", "q", "*", "\[Omega]", "*", "m"}]}], ")"}]}], 
              "-", 
              RowBox[{"144", 
               RowBox[{"\[Omega]", "^", "2"}], "*", 
               RowBox[{"q", "^", "2"}]}]}], ")"}], "^", 
            RowBox[{"(", 
             RowBox[{"1", "/", "2"}], ")"}]}], "-", 
           RowBox[{"12", "I", "*", "\[Omega]"}]}]}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"expPhaseVal", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"l", "+", "1"}], ")"}]}], "*", 
       RowBox[{"Cstar", "/", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "\[Omega]"}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "s"}], ")"}]}]}], "*", "BreflOverBinc"}]}], 
     ";", "\[IndentingNewLine]", "expPhaseVal"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9587400708218517`*^9, 3.958740089955854*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"319a9fe6-3458-4485-8db2-1358cc3a7eb7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Comparisons Between Expansion and Numerics", "Section",
 CellChangeTimes->{{3.9587392409150705`*^9, 
  3.958739261525693*^9}},ExpressionUUID->"364909b0-3741-44fa-9596-\
d5cc6e8816c8"],

Cell["Example comparisons are made below for s = 2, l = 2, m = 0.", "Text",
 CellChangeTimes->{{3.958739262934286*^9, 3.9587392808541603`*^9}, {
  3.9587396193599315`*^9, 3.958739623004184*^9}, {3.959854990634548*^9, 
  3.959855001931073*^9}},ExpressionUUID->"e107d3a6-9798-4e6d-b149-\
31b813d3afdc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nUp", "=", "5"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9587395143112707`*^9, 3.958739515030287*^9}, {
  3.958740201683123*^9, 3.9587402084864964`*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"72355be2-9dca-494e-8043-e649866975cc"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"plotNuI", "=", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Epsilon]0", ",", 
         RowBox[{"Re", "[", 
          RowBox[{"RenormalizedAngularMomentum", "[", 
           RowBox[{"2", ",", "2", ",", "0", ",", "0.5`32", ",", 
            RowBox[{"\[Epsilon]0", "/", "2"}]}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Epsilon]0", ",", "\[Epsilon]0Vals"}], "}"}]}], "]"}], ",", 
     RowBox[{"PlotStyle", "->", 
      RowBox[{"{", 
       RowBox[{"Blue", ",", 
        RowBox[{"Thickness", "[", "0.0025", "]"}]}], "}"}]}], ",", 
     RowBox[{"GridLines", "->", "Automatic"}], ",", 
     RowBox[{"AxesLabel", "->", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\[Epsilon] [/]\>\"", ",", 
        "\"\<\!\(\*TemplateBox[<|\"boxes\" -> FormBox[\"\[Nu]\", \
TraditionalForm], \"errors\" -> {}, \"input\" -> \"\\\\nu\", \"state\" -> \
\"Boxes\"|>,\"TeXAssistantTemplate\"]\) [/]\>\""}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotNuII", "=", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Epsilon]0", ",", 
         RowBox[{"\[Nu]220Expansion", "[", 
          RowBox[{"0.5`32", ",", "\[Epsilon]0"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Epsilon]0", ",", "\[Epsilon]0Vals"}], "}"}]}], "]"}], ",", 
     RowBox[{"PlotStyle", "->", 
      RowBox[{"{", 
       RowBox[{"Red", ",", 
        RowBox[{"Thickness", "[", "0.0025", "]"}]}], "}"}]}], ",", 
     RowBox[{"GridLines", "->", "Automatic"}], ",", 
     RowBox[{"AxesLabel", "->", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\[Epsilon] [/]\>\"", ",", 
        "\"\<\!\(\*TemplateBox[<|\"boxes\" -> FormBox[\"\[Nu]\", \
TraditionalForm], \"errors\" -> {}, \"input\" -> \"\\\\nu\", \"state\" -> \
\"Boxes\"|>,\"TeXAssistantTemplate\"]\) [/]\>\""}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotNu", "=", 
   RowBox[{"Show", "[", 
    RowBox[{"plotNuI", ",", "plotNuII", ",", 
     RowBox[{"PlotRange", "->", "All"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"plotNuLegended", "=", 
  RowBox[{"Legended", "[", 
   RowBox[{"plotNu", ",", 
    RowBox[{"LineLegend", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Blue", ",", "Red"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Numerical\>\"", ",", "\"\<Expansion\>\""}], "}"}]}], 
     "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.9598550793290715`*^9, 3.9598551331863174`*^9}, {
  3.9598551672341337`*^9, 3.9598551919732037`*^9}, {3.959855243935608*^9, 
  3.9598553029411483`*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"a7ca5006-7e7e-4170-82fb-346d9121d530"],

Cell[BoxData[
 TemplateBox[{
   GraphicsBox[{{{}, 
      InterpretationBox[{
        TagBox[{{}, {}, 
          TagBox[{
            RGBColor[0, 0, 1], 
            PointSize[
             NCache[
              Rational[7, 360], 0.019444444444444445`]], 
            Thickness[0.0025], 
            LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQXS2yzv1h1RT7/HvPnLT+/7ffIdf6OnDHPvvurUsn
nnn4314zpv/QV40z9vle96pcZv63h6i/Yp9zjtXKUOm//cMqkMAtezX5zWtf
lf6zX1Jgy3V98QP7S6HfHni1/7W/vhgk8Nj+w1675hDzP/ZcYIHn9ovTXkw+
xfjL3hYs8MqeAQwe2BeCBd7C+UFgB32A898EggQ+wvkg18q1fobyGRjkwQJf
4XyIf77B+RDzfsD5EPN+wvkQ836jmfcXzbx/cD4A/ed8Hg==
             "]]}, Annotation[#, "Charting`Private`Tag#1"]& ]}, {
         "WolframDynamicHighlight", <|
          "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>}], 
        DynamicBox[
         (Charting`HighlightActionBox["DynamicHighlight", {}, 
          Slot["HighlightElements"], 
          Slot["LayoutOptions"], 
          Slot["Meta"], 
          Charting`HighlightActionFunction["DynamicHighlight", {{{}, {}, 
             Annotation[{
               Hue[0.67, 0.6, 0.6], 
               Directive[
                PointSize[
                 Rational[7, 360]], 
                AbsoluteThickness[2], 
                RGBColor[0, 0, 1], 
                Thickness[0.0025]], 
               Line[CompressedData["
1:eJxTTMoPSmViYGAQAWIQXS2yzv1h1RT7/HvPnLT+/7ffIdf6OnDHPvvurUsn
nnn4314zpv/QV40z9vle96pcZv63h6i/Yp9zjtXKUOm//cMqkMAtezX5zWtf
lf6zX1Jgy3V98QP7S6HfHni1/7W/vhgk8Nj+w1675hDzP/ZcYIHn9ovTXkw+
xfjL3hYs8MqeAQwe2BeCBd7C+UFgB32A898EggQ+wvkg18q1fobyGRjkwQJf
4XyIf77B+RDzfsD5EPN+wvkQ836jmfcXzbx/cD4A/ed8Hg==
                "]]}, "Charting`Private`Tag#1"]}}, <|
           "HighlightElements" -> <|
             "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
            "LayoutOptions" -> <|
             "PlotRange" -> {{0, 1.92}, {0, 1.9997961629250331`}}, 
              "Frame" -> {{False, False}, {False, False}}, 
              "AxesOrigin" -> {0, 0}, "ImageSize" -> {360, 360/GoldenRatio}, 
              "Axes" -> {True, True}, "LabelStyle" -> {}, "AspectRatio" -> 
              GoldenRatio^(-1), "DefaultStyle" -> {
                Directive[
                 PointSize[
                  Rational[7, 360]], 
                 AbsoluteThickness[2], 
                 RGBColor[0, 0, 1], 
                 Thickness[0.0025]]}, 
              "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
                  Identity[
                   Part[#, 1]], 
                  Identity[
                   Part[#, 2]]}& ), 
                "ScalingFunctions" -> {{Identity, Identity}, {
                  Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
              False|>, 
            "Meta" -> <|
             "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, 
              "Function" -> ListLinePlot, "GroupHighlight" -> False|>|>]]& )[<|
          "HighlightElements" -> <|
            "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
           "LayoutOptions" -> <|
            "PlotRange" -> {{0, 1.92}, {0, 1.9997961629250331`}}, 
             "Frame" -> {{False, False}, {False, False}}, 
             "AxesOrigin" -> {0, 0}, "ImageSize" -> {360, 360/GoldenRatio}, 
             "Axes" -> {True, True}, "LabelStyle" -> {}, "AspectRatio" -> 
             GoldenRatio^(-1), "DefaultStyle" -> {
               Directive[
                PointSize[
                 Rational[7, 360]], 
                AbsoluteThickness[2], 
                RGBColor[0, 0, 1], 
                Thickness[0.0025]]}, 
             "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
                 Identity[
                  Part[#, 1]], 
                 Identity[
                  Part[#, 2]]}& ), 
               "ScalingFunctions" -> {{Identity, Identity}, {
                 Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
             False|>, 
           "Meta" -> <|
            "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, 
             "Function" -> ListLinePlot, "GroupHighlight" -> False|>|>], 
         ImageSizeCache -> {{4.503599627370496*^15, -4.503599627370496*^15}, {
          4.503599627370496*^15, -4.503599627370496*^15}}]}, 
       Annotation[{{{}, {}, 
          Annotation[{
            Hue[0.67, 0.6, 0.6], 
            Directive[
             PointSize[
              Rational[7, 360]], 
             AbsoluteThickness[2], 
             RGBColor[0, 0, 1], 
             Thickness[0.0025]], 
            Line[CompressedData["
1:eJxTTMoPSmViYGAQAWIQXS2yzv1h1RT7/HvPnLT+/7ffIdf6OnDHPvvurUsn
nnn4314zpv/QV40z9vle96pcZv63h6i/Yp9zjtXKUOm//cMqkMAtezX5zWtf
lf6zX1Jgy3V98QP7S6HfHni1/7W/vhgk8Nj+w1675hDzP/ZcYIHn9ovTXkw+
xfjL3hYs8MqeAQwe2BeCBd7C+UFgB32A898EggQ+wvkg18q1fobyGRjkwQJf
4XyIf77B+RDzfsD5EPN+wvkQ836jmfcXzbx/cD4A/ed8Hg==
             "]]}, "Charting`Private`Tag#1"]}}, <|
        "HighlightElements" -> <|
          "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
         "LayoutOptions" -> <|
          "PlotRange" -> {{0, 1.92}, {0, 1.9997961629250331`}}, 
           "Frame" -> {{False, False}, {False, False}}, 
           "AxesOrigin" -> {0, 0}, "ImageSize" -> {360, 360/GoldenRatio}, 
           "Axes" -> {True, True}, "LabelStyle" -> {}, "AspectRatio" -> 
           GoldenRatio^(-1), "DefaultStyle" -> {
             Directive[
              PointSize[
               Rational[7, 360]], 
              AbsoluteThickness[2], 
              RGBColor[0, 0, 1], 
              Thickness[0.0025]]}, 
           "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
               Identity[
                Part[#, 1]], 
               Identity[
                Part[#, 2]]}& ), 
             "ScalingFunctions" -> {{Identity, Identity}, {
               Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
           False|>, 
         "Meta" -> <|
          "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
           ListLinePlot, "GroupHighlight" -> False|>|>, 
        "DynamicHighlight"]], {{}, {}}}, {{}, 
      InterpretationBox[{
        TagBox[{{}, {}, 
          TagBox[{
            RGBColor[1, 0, 0], 
            PointSize[
             NCache[
              Rational[7, 360], 0.019444444444444445`]], 
            Thickness[0.0025], 
            LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQXS2yzv1h1RT7X7XPnbT+/7ffIdf6OnDHPvuECeys
Zx/+t9eM6T/0VeOM/d4ycc+wmf/tIeqv2BecWjDvqdJ/+4dVIIFb9pZrRJJe
Vv6zX1Jgy3V98QN7+yOn98jN+Gt/fTFI4LE9jxPb0omlf+y5wALP7XvvvL47
h+O3vS1Y4JW98KXu7y9df9oXggXe2oe9uONXqPDdPgjsoA/2BTl7eas6v9i/
CQQJfLS/Z/RZa1bBR3uQa+VaP9uz6YdfyWl/bS8PFvhq7/P723aWe4+g/vlm
f9y+tpyx5CLUvB/2O3/4xzybvmM/xLyf9vveeb/fvOvBfoh5v+03TpswWdny
w36IeX/t3UOzVsha/twPMe+f/YGJEm/m7mU8AADU5qto
             "]]}, Annotation[#, "Charting`Private`Tag#1"]& ]}, {
         "WolframDynamicHighlight", <|
          "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>}], 
        DynamicBox[
         (Charting`HighlightActionBox["DynamicHighlight", {}, 
          Slot["HighlightElements"], 
          Slot["LayoutOptions"], 
          Slot["Meta"], 
          Charting`HighlightActionFunction["DynamicHighlight", {{{}, {}, 
             Annotation[{
               Hue[0.67, 0.6, 0.6], 
               Directive[
                PointSize[
                 Rational[7, 360]], 
                AbsoluteThickness[2], 
                RGBColor[1, 0, 0], 
                Thickness[0.0025]], 
               Line[CompressedData["
1:eJxTTMoPSmViYGAQAWIQXS2yzv1h1RT7X7XPnbT+/7ffIdf6OnDHPvuECeys
Zx/+t9eM6T/0VeOM/d4ycc+wmf/tIeqv2BecWjDvqdJ/+4dVIIFb9pZrRJJe
Vv6zX1Jgy3V98QN7+yOn98jN+Gt/fTFI4LE9jxPb0omlf+y5wALP7XvvvL47
h+O3vS1Y4JW98KXu7y9df9oXggXe2oe9uONXqPDdPgjsoA/2BTl7eas6v9i/
CQQJfLS/Z/RZa1bBR3uQa+VaP9uz6YdfyWl/bS8PFvhq7/P723aWe4+g/vlm
f9y+tpyx5CLUvB/2O3/4xzybvmM/xLyf9vveeb/fvOvBfoh5v+03TpswWdny
w36IeX/t3UOzVsha/twPMe+f/YGJEm/m7mU8AADU5qto
                "]]}, "Charting`Private`Tag#1"]}}, <|
           "HighlightElements" -> <|
             "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
            "LayoutOptions" -> <|
             "PlotRange" -> {{0, 1.92}, {-2.2175863690374342`, 
                1.9997961629341021`}}, 
              "Frame" -> {{False, False}, {False, False}}, 
              "AxesOrigin" -> {0, 0}, "ImageSize" -> {360, 360/GoldenRatio}, 
              "Axes" -> {True, True}, "LabelStyle" -> {}, "AspectRatio" -> 
              GoldenRatio^(-1), "DefaultStyle" -> {
                Directive[
                 PointSize[
                  Rational[7, 360]], 
                 AbsoluteThickness[2], 
                 RGBColor[1, 0, 0], 
                 Thickness[0.0025]]}, 
              "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
                  Identity[
                   Part[#, 1]], 
                  Identity[
                   Part[#, 2]]}& ), 
                "ScalingFunctions" -> {{Identity, Identity}, {
                  Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
              False|>, 
            "Meta" -> <|
             "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, 
              "Function" -> ListLinePlot, "GroupHighlight" -> False|>|>]]& )[<|
          "HighlightElements" -> <|
            "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
           "LayoutOptions" -> <|
            "PlotRange" -> {{0, 1.92}, {-2.2175863690374342`, 
               1.9997961629341021`}}, 
             "Frame" -> {{False, False}, {False, False}}, 
             "AxesOrigin" -> {0, 0}, "ImageSize" -> {360, 360/GoldenRatio}, 
             "Axes" -> {True, True}, "LabelStyle" -> {}, "AspectRatio" -> 
             GoldenRatio^(-1), "DefaultStyle" -> {
               Directive[
                PointSize[
                 Rational[7, 360]], 
                AbsoluteThickness[2], 
                RGBColor[1, 0, 0], 
                Thickness[0.0025]]}, 
             "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
                 Identity[
                  Part[#, 1]], 
                 Identity[
                  Part[#, 2]]}& ), 
               "ScalingFunctions" -> {{Identity, Identity}, {
                 Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
             False|>, 
           "Meta" -> <|
            "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, 
             "Function" -> ListLinePlot, "GroupHighlight" -> False|>|>], 
         ImageSizeCache -> {{4.503599627370496*^15, -4.503599627370496*^15}, {
          4.503599627370496*^15, -4.503599627370496*^15}}]}, 
       Annotation[{{{}, {}, 
          Annotation[{
            Hue[0.67, 0.6, 0.6], 
            Directive[
             PointSize[
              Rational[7, 360]], 
             AbsoluteThickness[2], 
             RGBColor[1, 0, 0], 
             Thickness[0.0025]], 
            Line[CompressedData["
1:eJxTTMoPSmViYGAQAWIQXS2yzv1h1RT7X7XPnbT+/7ffIdf6OnDHPvuECeys
Zx/+t9eM6T/0VeOM/d4ycc+wmf/tIeqv2BecWjDvqdJ/+4dVIIFb9pZrRJJe
Vv6zX1Jgy3V98QN7+yOn98jN+Gt/fTFI4LE9jxPb0omlf+y5wALP7XvvvL47
h+O3vS1Y4JW98KXu7y9df9oXggXe2oe9uONXqPDdPgjsoA/2BTl7eas6v9i/
CQQJfLS/Z/RZa1bBR3uQa+VaP9uz6YdfyWl/bS8PFvhq7/P723aWe4+g/vlm
f9y+tpyx5CLUvB/2O3/4xzybvmM/xLyf9vveeb/fvOvBfoh5v+03TpswWdny
w36IeX/t3UOzVsha/twPMe+f/YGJEm/m7mU8AADU5qto
             "]]}, "Charting`Private`Tag#1"]}}, <|
        "HighlightElements" -> <|
          "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
         "LayoutOptions" -> <|
          "PlotRange" -> {{0, 1.92}, {-2.2175863690374342`, 
             1.9997961629341021`}}, 
           "Frame" -> {{False, False}, {False, False}}, 
           "AxesOrigin" -> {0, 0}, "ImageSize" -> {360, 360/GoldenRatio}, 
           "Axes" -> {True, True}, "LabelStyle" -> {}, "AspectRatio" -> 
           GoldenRatio^(-1), "DefaultStyle" -> {
             Directive[
              PointSize[
               Rational[7, 360]], 
              AbsoluteThickness[2], 
              RGBColor[1, 0, 0], 
              Thickness[0.0025]]}, 
           "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
               Identity[
                Part[#, 1]], 
               Identity[
                Part[#, 2]]}& ), 
             "ScalingFunctions" -> {{Identity, Identity}, {
               Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
           False|>, 
         "Meta" -> <|
          "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
           ListLinePlot, "GroupHighlight" -> False|>|>, 
        "DynamicHighlight"]], {{}, {}}}}, AspectRatio -> 
    NCache[GoldenRatio^(-1), 0.6180339887498948], Axes -> {True, True}, 
    AxesLabel -> {
      FormBox[
       TagBox["\"\[Epsilon] [/]\"", HoldForm], TraditionalForm], 
      FormBox[
       TagBox[
       "\"\\!\\(\\*TemplateBox[<|\\\"boxes\\\" -> FormBox[\\\"\[Nu]\\\", \
TraditionalForm], \\\"errors\\\" -> {}, \\\"input\\\" -> \\\"\\\\\\\\nu\\\", \
\\\"state\\\" -> \\\"Boxes\\\"|>,\\\"TeXAssistantTemplate\\\"]\\) [/]\"", 
        HoldForm], TraditionalForm]}, AxesOrigin -> {0, 0}, DisplayFunction -> 
    Identity, Frame -> {{False, False}, {False, False}}, 
    FrameLabel -> {{None, None}, {None, None}}, 
    FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
    GridLines -> {Automatic, Automatic}, GridLinesStyle -> Directive[
      GrayLevel[0.5, 0.4]], 
    Method -> {
     "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
      "DefaultGraphicsInteraction" -> {
       "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
        "Effects" -> {
         "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
          "Droplines" -> {
           "freeformCursorMode" -> True, 
            "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
      "DefaultMeshStyle" -> AbsolutePointSize[6], "DefaultPlotStyle" -> {
        Directive[
         RGBColor[0.368417, 0.506779, 0.709798], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.880722, 0.611041, 0.142051], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.560181, 0.691569, 0.194885], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.922526, 0.385626, 0.209179], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.528488, 0.470624, 0.701351], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.772079, 0.431554, 0.102387], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.363898, 0.618501, 0.782349], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[1, 0.75, 0], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.647624, 0.37816, 0.614037], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.571589, 0.586483, 0.], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.915, 0.3325, 0.2125], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
         AbsoluteThickness[2]]}, "DomainPadding" -> Scaled[0.02], 
      "RangePadding" -> Scaled[0.05], "OptimizePlotMarkers" -> True, 
      "IncludeHighlighting" -> "CurrentSet", "HighlightStyle" -> Automatic, 
      "OptimizePlotMarkers" -> True, 
      "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
          Identity[
           Part[#, 1]], 
          Identity[
           Part[#, 2]]}& ), "CopiedValueFunction" -> ({
          Identity[
           Part[#, 1]], 
          Identity[
           Part[#, 2]]}& )}}, PlotRange -> All, PlotRangeClipping -> True, 
    PlotRangePadding -> {{
       Scaled[0.02], 
       Scaled[0.02]}, {
       Scaled[0.02], 
       Scaled[0.05]}}, Ticks -> {Automatic, Automatic}], 
   FormBox[
    FormBox[
     TemplateBox[{"\"Numerical\"", "\"Expansion\""}, "LineLegend", 
      DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    RGBColor[0, 0, 1]], {
                    LineBox[{{0, 12.5}, {20, 12.5}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    RGBColor[0, 0, 1]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    RGBColor[1, 0, 0]], {
                    LineBox[{{0, 12.5}, {20, 12.5}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    RGBColor[1, 0, 0]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #2}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"LineLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               
               TemplateBox[<|"color" -> RGBColor[0, 0, 1]|>, 
                "RGBColorSwatchTemplate"], ",", 
               
               TemplateBox[<|"color" -> RGBColor[1, 0, 0]|>, 
                "RGBColorSwatchTemplate"]}], "}"}], ",", 
           RowBox[{"{", 
             RowBox[{#, ",", #2}], "}"}]}], "]"}]& ), Editable -> True], 
     TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{{3.959855227162599*^9, 3.9598553053546114`*^9}},
 CellLabel->"Out[45]=",ExpressionUUID->"d255873b-aa04-4f0e-931d-21e07a1159fb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"plotExpI", "=", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Epsilon]0", ",", 
         RowBox[{"Re", "[", 
          RowBox[{
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{"2", "I"}], ")"}]}], "*", 
           RowBox[{"Log", "[", 
            RowBox[{"expPhase", "[", 
             RowBox[{"n", ",", "nUp", ",", 
              RowBox[{"-", "2"}], ",", "2", ",", "0", ",", "0.5`32", ",", 
              "\[Epsilon]0"}], "]"}], "]"}]}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Epsilon]0", ",", "\[Epsilon]0Vals"}], "}"}]}], "]"}], ",", 
     RowBox[{"PlotStyle", "->", 
      RowBox[{"{", 
       RowBox[{"Blue", ",", 
        RowBox[{"Thickness", "[", "0.0025", "]"}]}], "}"}]}], ",", 
     RowBox[{"GridLines", "->", "Automatic"}], ",", 
     RowBox[{"AxesLabel", "->", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\[Epsilon] [/]\>\"", ",", 
        "\"\<\!\(\*TemplateBox[<|\"boxes\" -> FormBox[
RowBox[{
StyleBox[\"R\", \"TI\"], 
StyleBox[\"e\", \"TI\"], 
RowBox[{\"[\", 
SubscriptBox[\"\[Delta]\", 
RowBox[{\"20\", \"\[Omega]\"}]], \"]\"}]}], TraditionalForm], \"errors\" -> \
{}, \"input\" -> \"Re\\\\left[\\\\delta_{20\\\\omega}\\\\right]\", \"state\" \
-> \"Boxes\"|>,\"TeXAssistantTemplate\"]\) [/]\>\""}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotExpII", "=", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Epsilon]0", ",", 
         RowBox[{"Re", "[", 
          RowBox[{"phase220Expansion", "[", 
           RowBox[{"0.5`32", ",", "\[Epsilon]0"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Epsilon]0", ",", "\[Epsilon]0Vals"}], "}"}]}], "]"}], ",", 
     RowBox[{"PlotStyle", "->", 
      RowBox[{"{", 
       RowBox[{"Red", ",", 
        RowBox[{"Thickness", "[", "0.0025", "]"}]}], "}"}]}], ",", 
     RowBox[{"GridLines", "->", "Automatic"}], ",", 
     RowBox[{"AxesLabel", "->", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\[Epsilon] [/]\>\"", ",", 
        "\"\<\!\(\*TemplateBox[<|\"boxes\" -> FormBox[
RowBox[{
StyleBox[\"R\", \"TI\"], 
StyleBox[\"e\", \"TI\"], 
RowBox[{\"[\", 
SubscriptBox[\"\[Delta]\", 
RowBox[{\"20\", \"\[Omega]\"}]], \"]\"}]}], TraditionalForm], \"errors\" -> \
{}, \"input\" -> \"Re\\\\left[\\\\delta_{20\\\\omega}\\\\right]\", \"state\" \
-> \"Boxes\"|>,\"TeXAssistantTemplate\"]\) [/]\>\""}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotExp", "=", 
   RowBox[{"Show", "[", 
    RowBox[{"plotExpI", ",", "plotExpII", ",", 
     RowBox[{"PlotRange", "->", "All"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"plotExpLegended", "=", 
  RowBox[{"Legended", "[", 
   RowBox[{"plotExp", ",", 
    RowBox[{"LineLegend", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Blue", ",", "Red"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Numerical\>\"", ",", "\"\<Expansion\>\""}], "}"}]}], 
     "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.958739355117629*^9, 3.958739378243701*^9}, {
   3.9587394097540503`*^9, 3.9587394333352737`*^9}, {3.9587394833420963`*^9, 
   3.958739491398264*^9}, {3.9587395288205175`*^9, 3.9587395315039883`*^9}, 
   3.958739594724352*^9, {3.9587401964769354`*^9, 3.958740220727369*^9}, {
   3.9598545027703643`*^9, 3.959854525183664*^9}, {3.959854965750512*^9, 
   3.959854965927289*^9}, {3.95985507015984*^9, 3.9598550772935967`*^9}, {
   3.959855286036092*^9, 3.9598552886962767`*^9}, {3.959855373008602*^9, 
   3.9598553740847907`*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"002a0c15-c63e-477c-9ca9-431558f522a4"],

Cell[BoxData[
 TemplateBox[{
   GraphicsBox[{{{}, 
      InterpretationBox[{
        TagBox[{{}, {}, 
          TagBox[{
            RGBColor[0, 0, 1], 
            PointSize[
             NCache[
              Rational[7, 360], 0.019444444444444445`]], 
            Thickness[0.0025], 
            LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQXS2yzv1h1RT7qjtz2i/83Lp/h1zr68Ad++yjNfoC
JLov7deM6T/0VeOMvcaDHSpXpW/sh6i/Ym8U9dSLQ+3m/odVIIFb9k61Px7e
tb62f0mBLdf1xQ/sWeefjGyzO7f/+mKQwGP7gLPTz/LGLN3PBRZ4bs+bMjGs
+NMFe1uwwCv743+szkT0P7EvBAu8td9/5PTimV3v7IPADvpgX6G++vfMA5/s
3wSCBD7a2+5wLDji9tUe5Fq51s/2PPMOrXa2+G4vDxb4at9zNfRPxfEf9hD/
fLP31P59e5rxj/0Q837Yd2ebf9kk/30/xLyf9t9SqwVcTb/th5j32379b7FZ
qjlf90PM+2s/p/5PWcC+L9Dw+We/91m3rrn6l/0AuuiubA==
             "]]}, Annotation[#, "Charting`Private`Tag#1"]& ]}, {
         "WolframDynamicHighlight", <|
          "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>}], 
        DynamicBox[
         (Charting`HighlightActionBox["DynamicHighlight", {}, 
          Slot["HighlightElements"], 
          Slot["LayoutOptions"], 
          Slot["Meta"], 
          Charting`HighlightActionFunction["DynamicHighlight", {{{}, {}, 
             Annotation[{
               Hue[0.67, 0.6, 0.6], 
               Directive[
                PointSize[
                 Rational[7, 360]], 
                AbsoluteThickness[2], 
                RGBColor[0, 0, 1], 
                Thickness[0.0025]], 
               Line[CompressedData["
1:eJxTTMoPSmViYGAQAWIQXS2yzv1h1RT7qjtz2i/83Lp/h1zr68Ad++yjNfoC
JLov7deM6T/0VeOMvcaDHSpXpW/sh6i/Ym8U9dSLQ+3m/odVIIFb9k61Px7e
tb62f0mBLdf1xQ/sWeefjGyzO7f/+mKQwGP7gLPTz/LGLN3PBRZ4bs+bMjGs
+NMFe1uwwCv743+szkT0P7EvBAu8td9/5PTimV3v7IPADvpgX6G++vfMA5/s
3wSCBD7a2+5wLDji9tUe5Fq51s/2PPMOrXa2+G4vDxb4at9zNfRPxfEf9hD/
fLP31P59e5rxj/0Q837Yd2ebf9kk/30/xLyf9t9SqwVcTb/th5j32379b7FZ
qjlf90PM+2s/p/5PWcC+L9Dw+We/91m3rrn6l/0AuuiubA==
                "]]}, "Charting`Private`Tag#1"]}}, <|
           "HighlightElements" -> <|
             "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
            "LayoutOptions" -> <|
             "PlotRange" -> {{0, 1.92}, {-1.5125950425160275`, 
                1.5486993653151755`}}, 
              "Frame" -> {{False, False}, {False, False}}, 
              "AxesOrigin" -> {0, 0}, "ImageSize" -> {360, 360/GoldenRatio}, 
              "Axes" -> {True, True}, "LabelStyle" -> {}, "AspectRatio" -> 
              GoldenRatio^(-1), "DefaultStyle" -> {
                Directive[
                 PointSize[
                  Rational[7, 360]], 
                 AbsoluteThickness[2], 
                 RGBColor[0, 0, 1], 
                 Thickness[0.0025]]}, 
              "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
                  Identity[
                   Part[#, 1]], 
                  Identity[
                   Part[#, 2]]}& ), 
                "ScalingFunctions" -> {{Identity, Identity}, {
                  Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
              False|>, 
            "Meta" -> <|
             "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, 
              "Function" -> ListLinePlot, "GroupHighlight" -> False|>|>]]& )[<|
          "HighlightElements" -> <|
            "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
           "LayoutOptions" -> <|
            "PlotRange" -> {{0, 1.92}, {-1.5125950425160275`, 
               1.5486993653151755`}}, 
             "Frame" -> {{False, False}, {False, False}}, 
             "AxesOrigin" -> {0, 0}, "ImageSize" -> {360, 360/GoldenRatio}, 
             "Axes" -> {True, True}, "LabelStyle" -> {}, "AspectRatio" -> 
             GoldenRatio^(-1), "DefaultStyle" -> {
               Directive[
                PointSize[
                 Rational[7, 360]], 
                AbsoluteThickness[2], 
                RGBColor[0, 0, 1], 
                Thickness[0.0025]]}, 
             "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
                 Identity[
                  Part[#, 1]], 
                 Identity[
                  Part[#, 2]]}& ), 
               "ScalingFunctions" -> {{Identity, Identity}, {
                 Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
             False|>, 
           "Meta" -> <|
            "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, 
             "Function" -> ListLinePlot, "GroupHighlight" -> False|>|>], 
         ImageSizeCache -> {{4.503599627370496*^15, -4.503599627370496*^15}, {
          4.503599627370496*^15, -4.503599627370496*^15}}]}, 
       Annotation[{{{}, {}, 
          Annotation[{
            Hue[0.67, 0.6, 0.6], 
            Directive[
             PointSize[
              Rational[7, 360]], 
             AbsoluteThickness[2], 
             RGBColor[0, 0, 1], 
             Thickness[0.0025]], 
            Line[CompressedData["
1:eJxTTMoPSmViYGAQAWIQXS2yzv1h1RT7qjtz2i/83Lp/h1zr68Ad++yjNfoC
JLov7deM6T/0VeOMvcaDHSpXpW/sh6i/Ym8U9dSLQ+3m/odVIIFb9k61Px7e
tb62f0mBLdf1xQ/sWeefjGyzO7f/+mKQwGP7gLPTz/LGLN3PBRZ4bs+bMjGs
+NMFe1uwwCv743+szkT0P7EvBAu8td9/5PTimV3v7IPADvpgX6G++vfMA5/s
3wSCBD7a2+5wLDji9tUe5Fq51s/2PPMOrXa2+G4vDxb4at9zNfRPxfEf9hD/
fLP31P59e5rxj/0Q837Yd2ebf9kk/30/xLyf9t9SqwVcTb/th5j32379b7FZ
qjlf90PM+2s/p/5PWcC+L9Dw+We/91m3rrn6l/0AuuiubA==
             "]]}, "Charting`Private`Tag#1"]}}, <|
        "HighlightElements" -> <|
          "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
         "LayoutOptions" -> <|
          "PlotRange" -> {{0, 1.92}, {-1.5125950425160275`, 
             1.5486993653151755`}}, 
           "Frame" -> {{False, False}, {False, False}}, 
           "AxesOrigin" -> {0, 0}, "ImageSize" -> {360, 360/GoldenRatio}, 
           "Axes" -> {True, True}, "LabelStyle" -> {}, "AspectRatio" -> 
           GoldenRatio^(-1), "DefaultStyle" -> {
             Directive[
              PointSize[
               Rational[7, 360]], 
              AbsoluteThickness[2], 
              RGBColor[0, 0, 1], 
              Thickness[0.0025]]}, 
           "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
               Identity[
                Part[#, 1]], 
               Identity[
                Part[#, 2]]}& ), 
             "ScalingFunctions" -> {{Identity, Identity}, {
               Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
           False|>, 
         "Meta" -> <|
          "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
           ListLinePlot, "GroupHighlight" -> False|>|>, 
        "DynamicHighlight"]], {{}, {}}}, {{}, 
      InterpretationBox[{
        TagBox[{{}, {}, 
          TagBox[{
            RGBColor[1, 0, 0], 
            PointSize[
             NCache[
              Rational[7, 360], 0.019444444444444445`]], 
            Thickness[0.0025], 
            LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQXS2yzv1h1RT7qxErda783Lp/h1zr68Ad++yNuh+r
y/dc2q8Z03/oq8YZ+4O/RHfs17ixH6L+in392fb9a9Nv7n9YBRK4Ze+V+rgu
S/76/iUFtlzXFz+wz7yz8JPByov7ry8GCTy2P1Bz8VxNxKH9XGCB5/YWzgpr
/3gtsrcFC7yynxx5+4bsjgv2hWCBt/Ze+0tXnxR5aB8EdtAH+wlVtQt3h722
fxMIEvhof+leBv+XqZ/tQa6Va/1sv2tz3a5P/r/s5cECX+2Ten3D7r1ncID4
55v92rWnX4iosTpAzPth75O8RNP8HKcDxLyf9pd5HmixvOFzgJj3216wYFLf
GkchB4h5f+1Vlu5jFfMRhZr3z55xm/ID5+kSDgBhf6X5
             "]]}, Annotation[#, "Charting`Private`Tag#1"]& ]}, {
         "WolframDynamicHighlight", <|
          "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>}], 
        DynamicBox[
         (Charting`HighlightActionBox["DynamicHighlight", {}, 
          Slot["HighlightElements"], 
          Slot["LayoutOptions"], 
          Slot["Meta"], 
          Charting`HighlightActionFunction["DynamicHighlight", {{{}, {}, 
             Annotation[{
               Hue[0.67, 0.6, 0.6], 
               Directive[
                PointSize[
                 Rational[7, 360]], 
                AbsoluteThickness[2], 
                RGBColor[1, 0, 0], 
                Thickness[0.0025]], 
               Line[CompressedData["
1:eJxTTMoPSmViYGAQAWIQXS2yzv1h1RT7qxErda783Lp/h1zr68Ad++yNuh+r
y/dc2q8Z03/oq8YZ+4O/RHfs17ixH6L+in392fb9a9Nv7n9YBRK4Ze+V+rgu
S/76/iUFtlzXFz+wz7yz8JPByov7ry8GCTy2P1Bz8VxNxKH9XGCB5/YWzgpr
/3gtsrcFC7yynxx5+4bsjgv2hWCBt/Ze+0tXnxR5aB8EdtAH+wlVtQt3h722
fxMIEvhof+leBv+XqZ/tQa6Va/1sv2tz3a5P/r/s5cECX+2Ten3D7r1ncID4
55v92rWnX4iosTpAzPth75O8RNP8HKcDxLyf9pd5HmixvOFzgJj3216wYFLf
GkchB4h5f+1Vlu5jFfMRhZr3z55xm/ID5+kSDgBhf6X5
                "]]}, "Charting`Private`Tag#1"]}}, <|
           "HighlightElements" -> <|
             "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
            "LayoutOptions" -> <|
             "PlotRange" -> {{0, 1.92}, {-0.39695304588459374`, 
                6.147719862155555}}, 
              "Frame" -> {{False, False}, {False, False}}, 
              "AxesOrigin" -> {0, 0}, "ImageSize" -> {360, 360/GoldenRatio}, 
              "Axes" -> {True, True}, "LabelStyle" -> {}, "AspectRatio" -> 
              GoldenRatio^(-1), "DefaultStyle" -> {
                Directive[
                 PointSize[
                  Rational[7, 360]], 
                 AbsoluteThickness[2], 
                 RGBColor[1, 0, 0], 
                 Thickness[0.0025]]}, 
              "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
                  Identity[
                   Part[#, 1]], 
                  Identity[
                   Part[#, 2]]}& ), 
                "ScalingFunctions" -> {{Identity, Identity}, {
                  Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
              False|>, 
            "Meta" -> <|
             "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, 
              "Function" -> ListLinePlot, "GroupHighlight" -> False|>|>]]& )[<|
          "HighlightElements" -> <|
            "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
           "LayoutOptions" -> <|
            "PlotRange" -> {{0, 1.92}, {-0.39695304588459374`, 
               6.147719862155555}}, 
             "Frame" -> {{False, False}, {False, False}}, 
             "AxesOrigin" -> {0, 0}, "ImageSize" -> {360, 360/GoldenRatio}, 
             "Axes" -> {True, True}, "LabelStyle" -> {}, "AspectRatio" -> 
             GoldenRatio^(-1), "DefaultStyle" -> {
               Directive[
                PointSize[
                 Rational[7, 360]], 
                AbsoluteThickness[2], 
                RGBColor[1, 0, 0], 
                Thickness[0.0025]]}, 
             "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
                 Identity[
                  Part[#, 1]], 
                 Identity[
                  Part[#, 2]]}& ), 
               "ScalingFunctions" -> {{Identity, Identity}, {
                 Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
             False|>, 
           "Meta" -> <|
            "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, 
             "Function" -> ListLinePlot, "GroupHighlight" -> False|>|>], 
         ImageSizeCache -> {{4.503599627370496*^15, -4.503599627370496*^15}, {
          4.503599627370496*^15, -4.503599627370496*^15}}]}, 
       Annotation[{{{}, {}, 
          Annotation[{
            Hue[0.67, 0.6, 0.6], 
            Directive[
             PointSize[
              Rational[7, 360]], 
             AbsoluteThickness[2], 
             RGBColor[1, 0, 0], 
             Thickness[0.0025]], 
            Line[CompressedData["
1:eJxTTMoPSmViYGAQAWIQXS2yzv1h1RT7qxErda783Lp/h1zr68Ad++yNuh+r
y/dc2q8Z03/oq8YZ+4O/RHfs17ixH6L+in392fb9a9Nv7n9YBRK4Ze+V+rgu
S/76/iUFtlzXFz+wz7yz8JPByov7ry8GCTy2P1Bz8VxNxKH9XGCB5/YWzgpr
/3gtsrcFC7yynxx5+4bsjgv2hWCBt/Ze+0tXnxR5aB8EdtAH+wlVtQt3h722
fxMIEvhof+leBv+XqZ/tQa6Va/1sv2tz3a5P/r/s5cECX+2Ten3D7r1ncID4
55v92rWnX4iosTpAzPth75O8RNP8HKcDxLyf9pd5HmixvOFzgJj3216wYFLf
GkchB4h5f+1Vlu5jFfMRhZr3z55xm/ID5+kSDgBhf6X5
             "]]}, "Charting`Private`Tag#1"]}}, <|
        "HighlightElements" -> <|
          "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
         "LayoutOptions" -> <|
          "PlotRange" -> {{0, 1.92}, {-0.39695304588459374`, 
             6.147719862155555}}, "Frame" -> {{False, False}, {False, False}},
            "AxesOrigin" -> {0, 0}, "ImageSize" -> {360, 360/GoldenRatio}, 
           "Axes" -> {True, True}, "LabelStyle" -> {}, "AspectRatio" -> 
           GoldenRatio^(-1), "DefaultStyle" -> {
             Directive[
              PointSize[
               Rational[7, 360]], 
              AbsoluteThickness[2], 
              RGBColor[1, 0, 0], 
              Thickness[0.0025]]}, 
           "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
               Identity[
                Part[#, 1]], 
               Identity[
                Part[#, 2]]}& ), 
             "ScalingFunctions" -> {{Identity, Identity}, {
               Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
           False|>, 
         "Meta" -> <|
          "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
           ListLinePlot, "GroupHighlight" -> False|>|>, 
        "DynamicHighlight"]], {{}, {}}}}, AspectRatio -> 
    NCache[GoldenRatio^(-1), 0.6180339887498948], Axes -> {True, True}, 
    AxesLabel -> {
      FormBox[
       TagBox["\"\[Epsilon] [/]\"", HoldForm], TraditionalForm], 
      FormBox[
       TagBox[
       "\"\\!\\(\\*TemplateBox[<|\\\"boxes\\\" -> FormBox[RowBox[{StyleBox[\\\
\"R\\\", \\\"TI\\\"], StyleBox[\\\"e\\\", \\\"TI\\\"], RowBox[{\\\"[\\\", \
SubscriptBox[\\\"\[Delta]\\\", RowBox[{\\\"20\\\", \\\"\[Omega]\\\"}]], \\\"]\
\\\"}]}], TraditionalForm], \\\"errors\\\" -> {}, \\\"input\\\" -> \\\"Re\\\\\
\\\\left[\\\\\\\\delta_{20\\\\\\\\omega}\\\\\\\\right]\\\", \\\"state\\\" -> \
\\\"Boxes\\\"|>,\\\"TeXAssistantTemplate\\\"]\\) [/]\"", HoldForm], 
       TraditionalForm]}, AxesOrigin -> {0, 0}, DisplayFunction -> Identity, 
    Frame -> {{False, False}, {False, False}}, 
    FrameLabel -> {{None, None}, {None, None}}, 
    FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
    GridLines -> {Automatic, Automatic}, GridLinesStyle -> Directive[
      GrayLevel[0.5, 0.4]], 
    Method -> {
     "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
      "DefaultGraphicsInteraction" -> {
       "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
        "Effects" -> {
         "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
          "Droplines" -> {
           "freeformCursorMode" -> True, 
            "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
      "DefaultMeshStyle" -> AbsolutePointSize[6], "DefaultPlotStyle" -> {
        Directive[
         RGBColor[0.368417, 0.506779, 0.709798], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.880722, 0.611041, 0.142051], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.560181, 0.691569, 0.194885], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.922526, 0.385626, 0.209179], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.528488, 0.470624, 0.701351], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.772079, 0.431554, 0.102387], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.363898, 0.618501, 0.782349], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[1, 0.75, 0], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.647624, 0.37816, 0.614037], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.571589, 0.586483, 0.], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.915, 0.3325, 0.2125], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
         AbsoluteThickness[2]]}, "DomainPadding" -> Scaled[0.02], 
      "RangePadding" -> Scaled[0.05], "OptimizePlotMarkers" -> True, 
      "IncludeHighlighting" -> "CurrentSet", "HighlightStyle" -> Automatic, 
      "OptimizePlotMarkers" -> True, 
      "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
          Identity[
           Part[#, 1]], 
          Identity[
           Part[#, 2]]}& ), "CopiedValueFunction" -> ({
          Identity[
           Part[#, 1]], 
          Identity[
           Part[#, 2]]}& )}}, PlotRange -> All, PlotRangeClipping -> True, 
    PlotRangePadding -> {{
       Scaled[0.02], 
       Scaled[0.02]}, {
       Scaled[0.05], 
       Scaled[0.05]}}, Ticks -> {Automatic, Automatic}], 
   FormBox[
    FormBox[
     TemplateBox[{"\"Numerical\"", "\"Expansion\""}, "LineLegend", 
      DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    RGBColor[0, 0, 1]], {
                    LineBox[{{0, 12.5}, {20, 12.5}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    RGBColor[0, 0, 1]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    RGBColor[1, 0, 0]], {
                    LineBox[{{0, 12.5}, {20, 12.5}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    RGBColor[1, 0, 0]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #2}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"LineLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               
               TemplateBox[<|"color" -> RGBColor[0, 0, 1]|>, 
                "RGBColorSwatchTemplate"], ",", 
               
               TemplateBox[<|"color" -> RGBColor[1, 0, 0]|>, 
                "RGBColorSwatchTemplate"]}], "}"}], ",", 
           RowBox[{"{", 
             RowBox[{#, ",", #2}], "}"}]}], "]"}]& ), Editable -> True], 
     TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{{3.9587395117612257`*^9, 3.958739536508452*^9}, 
   3.9587395987595253`*^9, {3.958740215275011*^9, 3.958740224877709*^9}, 
   3.959854631537653*^9, 3.959854778996729*^9, 3.9598549218491845`*^9, 
   3.9598549701953363`*^9, 3.9598552937861986`*^9, {3.9598553666868677`*^9, 
   3.95985537833689*^9}},
 CellLabel->"Out[53]=",ExpressionUUID->"004fd23e-cb01-48f4-a267-09e4323ea28c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["(Extra) MST Coefficients Module", "Section",
 CellChangeTimes->{{3.9587372695304294`*^9, 
  3.958737302648642*^9}},ExpressionUUID->"b6894637-54b2-4d5b-b71a-\
49029b6289ba"],

Cell["\<\
A module calculating only the nn-th MST coefficient. Useful in seeing if the \
main module is converging properly, and to guide the choice of n and nUp. \
Except nn, the other inputs are the same as before.\
\>", "Text",
 CellChangeTimes->{{3.958739842623958*^9, 3.958739846668415*^9}, {
  3.9587399857096524`*^9, 
  3.958740060657836*^9}},ExpressionUUID->"dd51c689-2244-4c3b-8e9e-\
bc17c6c6c01b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ann", "[", 
   RowBox[{
   "n_", ",", "nn_", ",", "nUp_", ",", "s_", ",", "l_", ",", "m_", ",", "q_", 
    ",", "\[Epsilon]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]", ",", "\[Kappa]", ",", 
      "\[Tau]", ",", "\[Lambda]", ",", "\[Nu]", ",", "ii", ",", "Ri", ",", 
      "R", ",", "an"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Alpha]", "[", "i_", "]"}], ":=", 
      RowBox[{"I", "*", "\[Epsilon]", "*", "\[Kappa]", "*", 
       RowBox[{"(", 
        RowBox[{"i", "+", "\[Nu]", "+", "1", "+", "s", "+", 
         RowBox[{"I", "*", "\[Epsilon]"}]}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{"i", "+", "\[Nu]", "+", "1", "+", "s", "-", 
         RowBox[{"I", "*", "\[Epsilon]"}]}], ")"}], "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"i", "+", "\[Nu]", "+", "1", "+", 
          RowBox[{"I", "*", "\[Tau]"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"i", "+", "\[Nu]", "+", "1"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "*", "i"}], "+", 
            RowBox[{"2", "*", "\[Nu]"}], "+", "3"}], ")"}]}], ")"}]}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Beta]", "[", "i_", "]"}], ":=", 
      RowBox[{
       RowBox[{"-", "\[Lambda]"}], "-", 
       RowBox[{"s", "*", 
        RowBox[{"(", 
         RowBox[{"s", "+", "1"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"i", "+", "\[Nu]"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"i", "+", "\[Nu]", "+", "1"}], ")"}]}], "+", 
       RowBox[{"\[Epsilon]", "^", "2"}], "+", 
       RowBox[{"\[Epsilon]", "*", 
        RowBox[{"(", 
         RowBox[{"\[Epsilon]", "-", 
          RowBox[{"m", "*", "q"}]}], ")"}]}], "+", 
       RowBox[{"\[Epsilon]", "*", 
        RowBox[{"(", 
         RowBox[{"\[Epsilon]", "-", 
          RowBox[{"m", "*", "q"}]}], ")"}], "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"s", "^", "2"}], "+", 
           RowBox[{"\[Epsilon]", "^", "2"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "+", "\[Nu]"}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"i", "+", "\[Nu]", "+", "1"}], ")"}]}], ")"}]}]}]}]}], 
     " ", ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Gamma]", "[", "i_", "]"}], ":=", 
      RowBox[{
       RowBox[{"-", "I"}], "*", "\[Epsilon]", "*", "\[Kappa]", "*", 
       RowBox[{"(", 
        RowBox[{"i", "+", "\[Nu]", "-", "s", "+", 
         RowBox[{"I", "*", "\[Epsilon]"}]}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{"i", "+", "\[Nu]", "-", "s", "-", 
         RowBox[{"I", "*", "\[Epsilon]"}]}], ")"}], "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"i", "+", "\[Nu]", "-", 
          RowBox[{"I", "*", "\[Tau]"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"i", "+", "\[Nu]"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "i"}], "+", 
            RowBox[{"2", "\[Nu]"}], "-", "1"}], ")"}]}], ")"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]", "=", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"1", "-", 
        RowBox[{"q", "^", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Tau]", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Epsilon]", "-", 
         RowBox[{"m", "*", "q"}]}], ")"}], "/", "\[Kappa]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Lambda]", "=", 
      RowBox[{"SpinWeightedSpheroidalEigenvalue", "[", 
       RowBox[{"s", ",", "l", ",", "m", ",", 
        RowBox[{"q", "*", 
         RowBox[{"\[Epsilon]", "/", "2"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Nu]", "=", 
      RowBox[{"RenormalizedAngularMomentum", "[", 
       RowBox[{"s", ",", "l", ",", "m", ",", "q", ",", 
        RowBox[{"\[Epsilon]", "/", "2"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"ii", "=", 
        RowBox[{"n", "+", "nUp"}]}], ",", 
       RowBox[{"ii", ">=", "1"}], ",", 
       RowBox[{"ii", "--"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ii", "==", 
           RowBox[{"n", "+", "nUp"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Ri", "=", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"\[Gamma]", "[", "ii", "]"}]}], "/", 
            RowBox[{"\[Beta]", "[", "ii", "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Ri", "=", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"\[Gamma]", "[", "ii", "]"}]}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Beta]", "[", "ii", "]"}], "+", 
              RowBox[{
               RowBox[{"\[Alpha]", "[", "ii", "]"}], "*", 
               RowBox[{"R", "[", 
                RowBox[{"ii", "+", "1"}], "]"}]}]}], ")"}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"R", "[", "ii", "]"}], "=", "Ri"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"an", "[", "0", "]"}], "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"an", "[", "1", "]"}], "=", 
      RowBox[{"R", "[", "1", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"ii", "=", "2"}], ",", 
       RowBox[{"ii", "<=", "n"}], ",", 
       RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"an", "[", "ii", "]"}], "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"\[Beta]", "[", 
              RowBox[{"ii", "-", "1"}], "]"}]}], "*", 
            RowBox[{"an", "[", 
             RowBox[{"ii", "-", "1"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"\[Gamma]", "[", 
             RowBox[{"ii", "-", "1"}], "]"}], "*", 
            RowBox[{"an", "[", 
             RowBox[{"ii", "-", "2"}], "]"}]}]}], ")"}], "/", 
         RowBox[{"\[Alpha]", "[", 
          RowBox[{"ii", "-", "1"}], "]"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"ii", "=", 
        RowBox[{"-", "1"}]}], ",", 
       RowBox[{"ii", ">=", 
        RowBox[{"-", "n"}]}], ",", 
       RowBox[{"ii", "--"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"an", "[", "ii", "]"}], "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"\[Beta]", "[", 
              RowBox[{"ii", "+", "1"}], "]"}]}], "*", 
            RowBox[{"an", "[", 
             RowBox[{"ii", "+", "1"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"\[Alpha]", "[", 
             RowBox[{"ii", "+", "1"}], "]"}], "*", 
            RowBox[{"an", "[", 
             RowBox[{"ii", "+", "2"}], "]"}]}]}], ")"}], "/", 
         RowBox[{"\[Gamma]", "[", 
          RowBox[{"ii", "+", "1"}], "]"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"an", "[", "nn", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.95874025654348*^9, 3.958740274507412*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"23c2ceca-6c07-4f55-a398-8f189606fee8"],

Cell["\<\
An example plot showing the swift convergence of an MST coefficient for s, l, \
m = 0 as the order we determine it to, n, increases.\
\>", "Text",
 CellChangeTimes->{{3.9587405597763786`*^9, 3.958740575310276*^9}, {
  3.9587407622164755`*^9, 3.958740767698166*^9}, {3.9587412937315474`*^9, 
  3.9587413177443204`*^9}, {3.9587413956382494`*^9, 
  3.958741399113161*^9}},ExpressionUUID->"bde3d960-24a9-4a60-8c47-\
71861ef9fe8a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DiscretePlot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Abs", "[", 
     RowBox[{
      RowBox[{"ann", "[", 
       RowBox[{
        RowBox[{"n", "+", "1"}], ",", "2", ",", "1", ",", "0", ",", "0", ",", 
        "0", ",", "0.5`32", ",", "0.3`32"}], "]"}], "-", 
      RowBox[{"ann", "[", 
       RowBox[{
       "n", ",", "2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0.5`32", 
        ",", "0.3`32"}], "]"}]}], "]"}], "/", 
    RowBox[{"Abs", "[", 
     RowBox[{"ann", "[", 
      RowBox[{
      "n", ",", "2", ",", "5", ",", "0", ",", "0", ",", "0", ",", "0.5", ",", 
       "0.3"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", 
     RowBox[{"{", 
      RowBox[{
      "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",", "8", ",", 
       "9", ",", "10"}], "}"}]}], "}"}], ",", 
   RowBox[{"GridLines", "->", "Automatic"}], ",", 
   RowBox[{"AxesLabel", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<n [/]\>\"", ",", " ", "\"\<\>\""}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.958740585791137*^9, 3.9587406870295496`*^9}, {
  3.958740749405113*^9, 3.958740760811702*^9}, {3.95874085239557*^9, 
  3.9587408589730334`*^9}, {3.958741058341814*^9, 3.958741064863425*^9}, {
  3.9587411488137674`*^9, 3.95874115803141*^9}, {3.958741264891382*^9, 
  3.9587412834041457`*^9}, {3.9587413496933107`*^9, 3.9587413813068295`*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"650610f5-5511-4520-b493-b60704aff1f5"],

Cell[BoxData[
 GraphicsBox[{{
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[2], 
     TagBox[{
       {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
        0.012833333333333334`], AbsoluteThickness[2], Opacity[0.2], 
        LineBox[{{{8., 0.}, {8., 0}}, {{9., 0.}, {9., 0}}, {{10., 0.}, {
           10., 0}}},
         VertexColors->None]}, 
       {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
        0.012833333333333334`], AbsoluteThickness[2], Opacity[0.2], 
        LineBox[{{{2., 2.8845688561656042`*^-6}, {2., 0}}, {{3., 
           2.152433965039714*^-9}, {3., 0}}, {{4., 
           1.0883186010219774`*^-12}, {4., 0}}, {{5., 
           3.9806833239862855`*^-16}, {5., 0}}, {{6., 
           1.10304515462128*^-19}, {6., 0}}, {{7., 
           2.3967898796579874`*^-23}, {7., 0}}},
         VertexColors->None]}},
      Annotation[#, "Charting`Private`Tag$13828#1"]& ]}, 
    TagBox[
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.012833333333333334`], AbsoluteThickness[2], {}, 
      PointBox[{{2., 2.8845688561656042`*^-6}, {3., 2.152433965039714*^-9}, {
       4., 1.0883186010219774`*^-12}, {5., 3.9806833239862855`*^-16}, {6., 
       1.10304515462128*^-19}, {7., 2.3967898796579874`*^-23}, {8., 0.}, {9., 
       0.}, {10., 0.}}], {}},
     Annotation[#, "Charting`Private`Tag$13828#1"]& ]}, {}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{
    FormBox["\"n [/]\"", TraditionalForm], 
    FormBox["\"\"", TraditionalForm]},
  AxesOrigin->{2, 0},
  DisplayFunction->Identity,
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{Automatic, Automatic},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "MessagesHead" -> DiscretePlot, "AxisPadding" -> Scaled[0.02], 
    "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "DefaultPlotStyle" -> {
      Directive[
       RGBColor[0.368417, 0.506779, 0.709798], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.880722, 0.611041, 0.142051], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.560181, 0.691569, 0.194885], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.922526, 0.385626, 0.209179], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.528488, 0.470624, 0.701351], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.772079, 0.431554, 0.102387], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.363898, 0.618501, 0.782349], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[1, 0.75, 0], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.647624, 0.37816, 0.614037], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.571589, 0.586483, 0.], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.915, 0.3325, 0.2125], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
       AbsoluteThickness[2]]}, "DomainPadding" -> Scaled[0.02], 
    "PointSizeFunction" -> "SmallPointSize", "RangePadding" -> Scaled[0.05]},
  PlotRange->{{2, 10}, {0, 5.381084912599285*^-9}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.958740868755724*^9, 3.958741172193802*^9, 
  3.9587412680665436`*^9, 3.9587413846157207`*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"bd92bffb-f7d7-4670-8def-468cf56d53cc"]
}, Open  ]]
}, Closed]]
}, Open  ]]
},
WindowSize->{949, 461},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"13.3 for Microsoft Windows (64-bit) (July 24, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"18ab6de0-5063-4c70-a0c5-2640089f73e5"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 187, 3, 98, "Title",ExpressionUUID->"dcc1e1f8-3d52-4637-9663-3ad69970333c"],
Cell[CellGroupData[{
Cell[792, 29, 152, 3, 67, "Section",ExpressionUUID->"c7bc48bd-b8ea-45e1-a5dc-0a37c5881b39"],
Cell[947, 34, 176, 3, 35, "Text",ExpressionUUID->"10f5a757-d742-4adb-9113-7b8b588262ce"],
Cell[1126, 39, 336, 5, 67, "Input",ExpressionUUID->"aeb8ef5e-1618-4d69-b4c9-9cc8a8129c25"],
Cell[1465, 46, 496, 13, 37, "Text",ExpressionUUID->"02a874e2-8043-4f34-8cf3-748a1854f2dd"],
Cell[1964, 61, 507, 11, 28, "Input",ExpressionUUID->"41b327a6-2b05-46da-ba9b-c4b090eb8eff"],
Cell[2474, 74, 255, 6, 35, "Text",ExpressionUUID->"50d0239d-849b-4d42-80c9-013be3747125"],
Cell[2732, 82, 796, 24, 28, "Input",ExpressionUUID->"a5be18f4-c278-423e-82e6-5e780c5c73e1"],
Cell[3531, 108, 843, 22, 76, "Input",ExpressionUUID->"2e1662c3-8f4a-4eef-903f-f3e0db789073"],
Cell[4377, 132, 3186, 96, 146, "Input",ExpressionUUID->"0d0b26c7-99c8-4e88-b75f-ed90bf2cf2e1"],
Cell[7566, 230, 1270, 36, 86, "Input",ExpressionUUID->"bc15df0d-3963-416c-8ac3-33968c68f71e"],
Cell[8839, 268, 1436, 41, 88, "Input",ExpressionUUID->"d2d7177f-cb66-45c1-a0e0-517fd6891492"],
Cell[10278, 311, 1310, 37, 91, "Input",ExpressionUUID->"30b66338-171e-4fae-b6aa-fac1b8cef2ad"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11625, 353, 277, 4, 67, "Section",ExpressionUUID->"88c32fa4-0938-4d73-971f-41a0ab953349"],
Cell[11905, 359, 4148, 97, 295, "Text",ExpressionUUID->"6bcc4ed6-b175-443d-8da7-a06b554f55a9"],
Cell[16056, 458, 24442, 654, 999, "Input",ExpressionUUID->"319a9fe6-3458-4485-8db2-1358cc3a7eb7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40535, 1117, 189, 3, 67, "Section",ExpressionUUID->"364909b0-3741-44fa-9596-d5cc6e8816c8"],
Cell[40727, 1122, 300, 4, 35, "Text",ExpressionUUID->"e107d3a6-9798-4e6d-b149-31b813d3afdc"],
Cell[41030, 1128, 337, 7, 48, "Input",ExpressionUUID->"72355be2-9dca-494e-8043-e649866975cc"],
Cell[CellGroupData[{
Cell[41392, 1139, 2823, 72, 134, "Input",ExpressionUUID->"a7ca5006-7e7e-4170-82fb-346d9121d530"],
Cell[44218, 1213, 20746, 467, 243, "Output",ExpressionUUID->"d255873b-aa04-4f0e-931d-21e07a1159fb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65001, 1685, 3780, 96, 134, "Input",ExpressionUUID->"002a0c15-c63e-477c-9ca9-431558f522a4"],
Cell[68784, 1783, 21670, 482, 234, "Output",ExpressionUUID->"004fd23e-cb01-48f4-a267-09e4323ea28c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[90503, 2271, 178, 3, 67, "Section",ExpressionUUID->"b6894637-54b2-4d5b-b71a-49029b6289ba"],
Cell[90684, 2276, 407, 8, 58, "Text",ExpressionUUID->"dd51c689-2244-4c3b-8e9e-bc17c6c6c01b"],
Cell[91094, 2286, 7534, 202, 390, "Input",ExpressionUUID->"23c2ceca-6c07-4f55-a398-8f189606fee8"],
Cell[98631, 2490, 436, 8, 35, "Text",ExpressionUUID->"bde3d960-24a9-4a60-8c47-71861ef9fe8a"],
Cell[CellGroupData[{
Cell[99092, 2502, 1463, 35, 67, "Input",ExpressionUUID->"650610f5-5511-4520-b493-b60704aff1f5"],
Cell[100558, 2539, 4329, 106, 226, "Output",ExpressionUUID->"bd92bffb-f7d7-4670-8def-468cf56d53cc"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}
]
*)

